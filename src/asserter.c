/**
 * @file 
 * @author Ian Ress
 * @brief See @ref asserter.h
 * @version 0.1
 * @date 2024-03-02
 * 
 * @copyright Copyright (c) 2024
 * 
 */


/* Translation unit. */
#include <ecu/asserter.h>



/*---------------------------------------------------------------------------------------------------------------------------*/
/*-------------------------------------------------- STATIC FUNCTION DECLARATIONS -------------------------------------------*/
/*---------------------------------------------------------------------------------------------------------------------------*/

static void default_assert_handler(void);



/*---------------------------------------------------------------------------------------------------------------------------*/
/*--------------------------------------------------- STATIC FUNCTION DEFINITIONS -------------------------------------------*/
/*---------------------------------------------------------------------------------------------------------------------------*/

static void default_assert_handler(void)
{
#if !defined(NDEBUG)
    while (1)
    {
        /* Permanently hang to inspect call stack. */
    }
#endif
}



/*---------------------------------------------------------------------------------------------------------------------------*/
/*------------------------------------------------------- PRIVATE FUNCTIONS -------------------------------------------------*/
/*---------------------------------------------------------------------------------------------------------------------------*/

void ecu_assert_do_not_use(struct ecu_assert_functor *me, const char *file, int line)
{
    if (me)
    {
        if (me->handler)
        {
            (*me->handler)(me, file, line); /* user-defined handler. */
        }
        else
        {
            default_assert_handler();
        }
    }
    else
    {
        default_assert_handler();
    }
}
